
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>동물원 골프 매니저</title>
    <!-- 필수 라이브러리 (안정적인 UMD 버전) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', 'Pretendard', sans-serif; -webkit-font-smoothing: antialiased; margin: 0; padding: 0; }
        .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        #root:empty::before {
            content: "시스템 가동 중...";
            display: flex; justify-content: center; align-items: center; height: 100vh;
            color: #059669; font-weight: 900; font-size: 1.2rem; background: #f8fafc;
        }
    </style>
<script type="importmap">
{
  "imports": {
    "@google/genai": "https://esm.sh/@google/genai@^1.35.0"
  }
}
</script>
</head>
<body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- 내장 SVG 아이콘 (외부 라이브러리 오류 방지) ---
        const Icon = ({ name, size = 20 }) => {
            const icons = {
                dashboard: <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/>,
                calendar: <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/>,
                notice: <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/>,
                wallet: <rect x="2" y="5" width="20" height="14" rx="2"/><line x1="2" y1="10" x2="22" y2="10"/>,
                users: <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/>,
                plus: <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>,
                trash: <polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>,
                refresh: <polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>,
                x: <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
            };
            return (
                <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    {icons[name] || <circle cx="12" cy="12" r="10" />}
                </svg>
            );
        };

        function App() {
            const [view, setView] = useState('DASHBOARD');
            const [members, setMembers] = useState([]);
            const [notices, setNotices] = useState([]);
            const [finances, setFinances] = useState([]);
            const [meetings, setMeetings] = useState([]);
            const [modal, setModal] = useState(null);

            // 초기 로드 및 공유 데이터 처리
            useEffect(() => {
                const urlParams = new URLSearchParams(window.location.search);
                const sharedData = urlParams.get('data');
                if (sharedData) {
                    try {
                        const decoded = JSON.parse(decodeURIComponent(atob(sharedData)));
                        if (confirm('새로운 데이터를 동기화할까요?')) {
                            setMembers(decoded.members || []);
                            setNotices(decoded.notices || []);
                            setFinances(decoded.finances || []);
                            setMeetings(decoded.meetings || []);
                            window.history.replaceState({}, "", window.location.pathname);
                        }
                    } catch(e) {}
                }
                const load = (k) => JSON.parse(localStorage.getItem(k) || '[]');
                setMembers(load('zoo_members')); setNotices(load('zoo_notices')); setFinances(load('zoo_finances')); setMeetings(load('zoo_meetings'));
            }, []);

            useEffect(() => {
                localStorage.setItem('zoo_members', JSON.stringify(members));
                localStorage.setItem('zoo_notices', JSON.stringify(notices));
                localStorage.setItem('zoo_finances', JSON.stringify(finances));
                localStorage.setItem('zoo_meetings', JSON.stringify(meetings));
            }, [members, notices, finances, meetings]);

            const totalBalance = useMemo(() => finances.reduce((a, c) => c.type === 'INCOME' ? a + c.amount : a - c.amount, 0), [finances]);

            const share = () => {
                const data = btoa(encodeURIComponent(JSON.stringify({members, notices, finances, meetings})));
                const url = `${window.location.origin}${window.location.pathname}?data=${data}`;
                navigator.clipboard.writeText(url).then(() => alert('공유 링크가 복사되었습니다!'));
            };

            const Modal = ({ title, onSave, children }) => (
                <div className="fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4">
                    <div className="bg-white rounded-[2rem] w-full max-w-sm overflow-hidden animate-fade-in shadow-2xl">
                        <div className="p-6 border-b flex justify-between font-black text-xl bg-slate-50">
                            {title}
                            <button onClick={() => setModal(null)} className="text-slate-400">×</button>
                        </div>
                        <form onSubmit={(e) => { e.preventDefault(); onSave(new FormData(e.target)); setModal(null); }} className="p-6 space-y-4">
                            {children}
                            <button type="submit" className="w-full bg-emerald-600 text-white py-4 rounded-2xl font-black shadow-lg">저장하기</button>
                        </form>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen flex flex-col lg:flex-row">
                    {/* 데스크탑 메뉴 */}
                    <nav className="hidden lg:flex flex-col w-64 bg-white border-r p-8 sticky top-0 h-screen">
                        <div className="flex items-center space-x-3 mb-10">
                            <div className="w-10 h-10 bg-emerald-600 rounded-xl flex items-center justify-center text-white font-black italic">Z</div>
                            <span className="text-xl font-black">동물원 골프</span>
                        </div>
                        <div className="space-y-2 flex-1">
                            {[
                                {id:'DASHBOARD', n:'대시보드', i:'dashboard'},
                                {id:'ATTENDANCE', n:'참석체크', i:'calendar'},
                                {id:'NOTICES', n:'공지사항', i:'notice'},
                                {id:'FINANCES', n:'회비내역', i:'wallet'},
                                {id:'MEMBERS', n:'회원관리', i:'users'}
                            ].map(m => (
                                <button key={m.id} onClick={() => setView(m.id)} className={`w-full flex items-center space-x-4 px-4 py-3 rounded-2xl font-bold transition ${view === m.id ? 'bg-emerald-600 text-white' : 'text-slate-400 hover:bg-slate-50'}`}>
                                    <Icon name={m.i} /> <span>{m.n}</span>
                                </button>
                            ))}
                        </div>
                        <div className="p-5 bg-emerald-50 rounded-2xl">
                            <div className="text-[0.6rem] font-black text-emerald-600 mb-1 uppercase tracking-widest">Balance</div>
                            <div className="text-xl font-black">{totalBalance.toLocaleString()}원</div>
                        </div>
                    </nav>

                    {/* 모바일 하단 탭 바 */}
                    <nav className="lg:hidden fixed bottom-0 left-0 right-0 bg-white border-t z-50 flex justify-around p-4 shadow-2xl">
                        <button onClick={()=>setView('DASHBOARD')} className={view==='DASHBOARD'?'text-emerald-600':'text-slate-300'}><Icon name="dashboard" /></button>
                        <button onClick={()=>setView('ATTENDANCE')} className={view==='ATTENDANCE'?'text-emerald-600':'text-slate-300'}><Icon name="calendar" /></button>
                        <button onClick={()=>setView('NOTICES')} className={view==='NOTICES'?'text-emerald-600':'text-slate-300'}><Icon name="notice" /></button>
                        <button onClick={()=>setView('FINANCES')} className={view==='FINANCES'?'text-emerald-600':'text-slate-300'}><Icon name="wallet" /></button>
                        <button onClick={()=>setView('MEMBERS')} className={view==='MEMBERS'?'text-emerald-600':'text-slate-300'}><Icon name="users" /></button>
                    </nav>

                    {/* 메인 콘텐츠 */}
                    <main className="flex-1 p-6 lg:p-12 pb-24 max-w-5xl mx-auto w-full">
                        {view === 'DASHBOARD' && (
                            <div className="space-y-10 animate-fade-in">
                                <header className="flex justify-between items-end">
                                    <div><h1 className="text-5xl font-black tracking-tighter">클럽 동물원</h1><p className="text-slate-500 font-bold">우리 모임의 현황판입니다.</p></div>
                                    <button onClick={share} className="hidden lg:flex items-center space-x-2 bg-emerald-600 text-white px-6 py-4 rounded-2xl font-black shadow-xl"><Icon name="refresh" size={16}/><span>카톡 공유</span></button>
                                </header>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                    <div className="bg-white p-10 rounded-[2.5rem] border shadow-sm"><h3 className="text-xs font-black text-slate-400 mb-2">잔액</h3><p className="text-3xl font-black text-emerald-600">{totalBalance.toLocaleString()}원</p></div>
                                    <div className="bg-white p-10 rounded-[2.5rem] border shadow-sm"><h3 className="text-xs font-black text-slate-400 mb-2">회원수</h3><p className="text-3xl font-black">{members.length}명</p></div>
                                    <div className="bg-white p-10 rounded-[2.5rem] border shadow-sm"><h3 className="text-xs font-black text-slate-400 mb-2">다음 장소</h3><p className="text-3xl font-black">{meetings[0]?.location || '미정'}</p></div>
                                </div>
                                <button onClick={share} className="lg:hidden w-full bg-emerald-600 text-white py-5 rounded-3xl font-black shadow-xl">데이터 동기화 링크 생성</button>
                            </div>
                        )}

                        {view === 'ATTENDANCE' && (
                            <div className="space-y-8 animate-fade-in">
                                <div className="flex justify-between items-center"><h2 className="text-4xl font-black">참석체크</h2><button onClick={()=>setModal('MT')} className="bg-emerald-600 text-white p-5 rounded-2xl shadow-xl"><Icon name="plus"/></button></div>
                                {meetings.map(m => (
                                    <div key={m.id} className="bg-white rounded-[2.5rem] border shadow-sm overflow-hidden">
                                        <div className="p-8 bg-slate-50 border-b flex justify-between items-center">
                                            <div><div className="font-black text-2xl">{m.location}</div><div className="text-slate-400 font-bold">{m.date}</div></div>
                                            <button onClick={()=>{if(confirm('삭제?'))setMeetings(meetings.filter(i=>i.id!==m.id))}} className="text-slate-200 hover:text-red-500"><Icon name="trash"/></button>
                                        </div>
                                        <div className="p-8 grid grid-cols-1 sm:grid-cols-2 gap-4">
                                            {members.map(mem => (
                                                <div key={mem.id} className="flex justify-between items-center p-5 bg-slate-50 rounded-2xl">
                                                    <span className="font-black text-slate-700">{mem.name}</span>
                                                    <div className="flex bg-white p-1 rounded-xl shadow-inner">
                                                        {['참석', '불참'].map(s => (
                                                            <button key={s} onClick={() => {
                                                                setMeetings(meetings.map(mt => mt.id === m.id ? {...mt, attendance: {...mt.attendance, [mem.id]: s}} : mt));
                                                            }} className={`px-5 py-2 rounded-lg text-sm font-black transition ${m.attendance[mem.id] === s ? 'bg-emerald-600 text-white shadow-md' : 'text-slate-300'}`}>{s}</button>
                                                        ))}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}

                        {view === 'NOTICES' && (
                            <div className="space-y-6 animate-fade-in">
                                <div className="flex justify-between items-center"><h2 className="text-4xl font-black">공지사항</h2><button onClick={()=>setModal('N')} className="bg-emerald-600 text-white p-5 rounded-2xl shadow-xl"><Icon name="plus"/></button></div>
                                {notices.map(n => (
                                    <div key={n.id} className="bg-white p-10 rounded-[2.5rem] border shadow-sm relative">
                                        <button onClick={()=>{if(confirm('삭제?'))setNotices(notices.filter(i=>i.id!==n.id))}} className="absolute top-10 right-10 text-slate-200 hover:text-red-500"><Icon name="trash"/></button>
                                        <div className="text-emerald-600 text-xs font-black mb-4 uppercase tracking-[0.2em]">{n.date}</div>
                                        <h3 className="text-3xl font-black mb-6">{n.title}</h3>
                                        <p className="text-slate-500 font-medium text-lg leading-relaxed whitespace-pre-wrap">{n.content}</p>
                                    </div>
                                ))}
                            </div>
                        )}

                        {view === 'FINANCES' && (
                            <div className="space-y-8 animate-fade-in">
                                <div className="flex justify-between items-center"><h2 className="text-4xl font-black">회비내역</h2><button onClick={()=>setModal('F')} className="bg-emerald-600 text-white p-5 rounded-2xl shadow-xl"><Icon name="plus"/></button></div>
                                <div className="bg-white rounded-[2.5rem] border shadow-sm overflow-hidden">
                                    <table className="w-full text-left">
                                        <thead className="bg-slate-50 text-slate-400 text-xs font-black border-b"><tr className=""><th className="p-8">내역</th><th className="p-8 text-right">금액</th></tr></thead>
                                        <tbody className="divide-y divide-slate-50">
                                            {finances.map(f => (
                                                <tr key={f.id} className="hover:bg-slate-50/50">
                                                    <td className="p-8">
                                                        <div className="text-xs font-bold text-slate-400">{f.date}</div>
                                                        <div className="font-black text-xl text-slate-800">{f.description}</div>
                                                    </td>
                                                    <td className={`p-8 text-right font-black text-2xl ${f.type==='INCOME'?'text-emerald-600':'text-red-500'}`}>
                                                        {f.type==='INCOME'?'+':'-'}{f.amount.toLocaleString()}원
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}

                        {view === 'MEMBERS' && (
                            <div className="space-y-8 animate-fade-in">
                                <div className="flex justify-between items-center"><h2 className="text-4xl font-black">회원관리</h2><button onClick={()=>setModal('M')} className="bg-emerald-600 text-white p-5 rounded-2xl shadow-xl"><Icon name="plus"/></button></div>
                                <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                                    {members.map(m => (
                                        <div key={m.id} className="bg-white p-8 rounded-[2rem] border shadow-sm flex items-center justify-between group">
                                            <div className="flex items-center space-x-5">
                                                <div className="w-16 h-16 bg-emerald-600 rounded-2xl flex items-center justify-center text-white font-black text-2xl shadow-lg shadow-emerald-50">{m.name[0]}</div>
                                                <div><div className="font-black text-xl">{m.name}</div><div className="text-xs font-black text-emerald-600 uppercase tracking-widest">{m.role}</div></div>
                                            </div>
                                            <button onClick={()=>{if(confirm('삭제?'))setMembers(members.filter(i=>i.id!==m.id))}} className="text-slate-200 group-hover:text-red-500 transition"><Icon name="trash"/></button>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}
                    </main>

                    {/* 모달 창들 */}
                    {modal === 'M' && (
                        <Modal title="회원 추가" onSave={(fd) => setMembers([...members, {id:Date.now(), name:fd.get('n'), role:fd.get('r')}])}>
                            <input name="n" placeholder="이름" required className="w-full p-5 bg-slate-50 rounded-2xl font-black outline-none focus:ring-2 ring-emerald-600" />
                            <select name="r" className="w-full p-5 bg-slate-50 rounded-2xl font-black outline-none"><option value="회원">회원</option><option value="총무">총무</option><option value="회장">회장</option></select>
                        </Modal>
                    )}
                    {modal === 'N' && (
                        <Modal title="공지사항 작성" onSave={(fd) => setNotices([{id:Date.now(), title:fd.get('t'), content:fd.get('c'), date:new Date().toISOString().split('T')[0]}, ...notices])}>
                            <input name="t" placeholder="제목" required className="w-full p-5 bg-slate-50 rounded-2xl font-black outline-none" />
                            <textarea name="c" placeholder="내용" required className="w-full p-5 bg-slate-50 rounded-2xl font-bold outline-none h-40" />
                        </Modal>
                    )}
                    {modal === 'MT' && (
                        <Modal title="일정 추가" onSave={(fd) => setMeetings([{id:Date.now(), date:fd.get('d'), location:fd.get('l'), attendance:{}}, ...meetings])}>
                            <input name="d" type="date" required className="w-full p-5 bg-slate-50 rounded-2xl font-black outline-none" />
                            <input name="l" placeholder="골프장 장소" required className="w-full p-5 bg-slate-50 rounded-2xl font-black outline-none" />
                        </Modal>
                    )}
                    {modal === 'F' && (
                        <Modal title="회비 추가" onSave={(fd) => setFinances([{id:Date.now(), date:fd.get('d'), description:fd.get('ds'), amount:Number(fd.get('a')), type:fd.get('t')}, ...finances])}>
                            <input name="d" type="date" defaultValue={new Date().toISOString().split('T')[0]} required className="w-full p-5 bg-slate-50 rounded-2xl font-black outline-none" />
                            <input name="ds" placeholder="내역" required className="w-full p-5 bg-slate-50 rounded-2xl font-black outline-none" />
                            <input name="a" type="number" placeholder="금액" required className="w-full p-5 bg-slate-50 rounded-2xl font-black outline-none" />
                            <div className="flex space-x-3">
                                <label className="flex-1"><input type="radio" name="t" value="INCOME" defaultChecked className="hidden peer" /><div className="p-4 text-center bg-slate-100 rounded-2xl peer-checked:bg-emerald-600 peer-checked:text-white font-black transition">입금</div></label>
                                <label className="flex-1"><input type="radio" name="t" value="EXPENSE" className="hidden peer" /><div className="p-4 text-center bg-slate-100 rounded-2xl peer-checked:bg-red-500 peer-checked:text-white font-black transition">지출</div></label>
                            </div>
                        </Modal>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
